From 94645ea8341ec6bbd37eab18b17adcfb12c48690 Mon Sep 17 00:00:00 2001
From: niqiang <niqiang@uniontech.com>
Date: Mon, 1 Jun 2020 21:09:05 +0800
Subject: [PATCH 24/29] =?UTF-8?q?=E5=AF=B9=E8=AE=BE=E7=BD=AE=E4=B8=AD?=
 =?UTF-8?q?=E7=9A=84=E5=AD=97=E4=BD=93=E5=A4=A7=E5=B0=8F=E6=9C=80=E5=A4=A7?=
 =?UTF-8?q?=E5=80=BC=E8=BF=9B=E8=A1=8C=E4=BA=86=E9=99=90=E5=88=B6=EF=BC=8C?=
 =?UTF-8?q?=E7=9B=AE=E5=89=8D=E6=9C=80=E5=A4=A7=E5=80=BC=E4=B8=BA30?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

---
 .../deepin-fcitx-fontsize-max-nolimit.patch   | 38 +++++++++++++++++++
 debian/patches/series                         |  1 +
 2 files changed, 39 insertions(+)
 create mode 100644 debian/patches/deepin-fcitx-fontsize-max-nolimit.patch

diff --git a/debian/patches/deepin-fcitx-fontsize-max-nolimit.patch b/debian/patches/deepin-fcitx-fontsize-max-nolimit.patch
new file mode 100644
index 0000000..159e37e
--- /dev/null
+++ b/debian/patches/deepin-fcitx-fontsize-max-nolimit.patch
@@ -0,0 +1,38 @@
+Description: 设置中对字体最大值进行了限制，最大允许设在为30
+Bug:	     https://pms.uniontech.com/zentao/task-view-21390.html
+Author:	     niqiang
+Reviewed-By: huxiaodong
+Last-Update: 2020-06-01
+
+Index: fcitx-4.2.9.19/src/lib/fcitx-config/fcitx-config.c
+===================================================================
+--- fcitx-4.2.9.19.orig/src/lib/fcitx-config/fcitx-config.c
++++ fcitx-4.2.9.19/src/lib/fcitx-config/fcitx-config.c
+@@ -432,9 +432,12 @@ FcitxConfigSyncResult FcitxConfigOptionI
+ 
+     case Raw2Value: {
+         int value = atoi(option->rawValue);
+-        if (value > option->optionDesc2->constrain.integerConstrain.max || value < option->optionDesc2->constrain.integerConstrain.min)
+-            return SyncInvalid;
+-        *option->value.integer = value;
++	if (value > option->optionDesc2->constrain.integerConstrain.max)
++	    *option->value.integer = option->optionDesc2->constrain.integerConstrain.max;
++	else if (value < option->optionDesc2->constrain.integerConstrain.min)
++	    *option->value.integer = option->optionDesc2->constrain.integerConstrain.min;
++	else
++            *option->value.integer = value;
+         return SyncSuccess;
+     }
+ 
+Index: fcitx-4.2.9.19/src/ui/classic/fcitx-classic-ui.desc
+===================================================================
+--- fcitx-4.2.9.19.orig/src/ui/classic/fcitx-classic-ui.desc
++++ fcitx-4.2.9.19/src/ui/classic/fcitx-classic-ui.desc
+@@ -15,6 +15,7 @@ Type=Integer
+ DefaultValue=0
+ Description=Font Size
+ Min=0
++Max=30
+ LongDescription=Override the skin font size
+ 
+ [ClassicUI/Font]
diff --git a/debian/patches/series b/debian/patches/series
index bce07b5..83fc0df 100644
--- a/debian/patches/series
+++ b/debian/patches/series
@@ -12,3 +12,4 @@ deepin-active-input-method-default.patch
 deepin-remove-configure-current-input-method.patch
 deepin-fcitx-menu-right-click-icon-change.patch
 deepin-fcitx-icon-change-to-keyboard.patch
+deepin-fcitx-fontsize-max-nolimit.patch
-- 
2.20.1

